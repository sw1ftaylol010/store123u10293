# üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –î–û–†–ê–ë–û–¢–ö–ò - –í–ù–ï–î–†–ï–ù–û

–î–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è –¥–ª—è production-ready –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Lonieve Gift.

---

## ‚úÖ 1. –Æ–†–ò–î–ò–ö–ê –ò –î–û–í–ï–†–ò–ï

### 1.1. –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

**–°–æ–∑–¥–∞–Ω—ã –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (20-30 —Å—Ç—Ä–∞–Ω–∏—Ü —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–∞):**

#### Terms of Service (`/[locale]/terms`)
- **13 —Ä–∞–∑–¥–µ–ª–æ–≤** –ø–æ–ª–Ω–æ–≥–æ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è
- –ö–ª—é—á–µ–≤—ã–µ –ø—É–Ω–∫—Ç—ã:
  - Acceptance of Terms (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–≥–ª–∞—à–µ–Ω–∏—è)
  - Description of Service (—á—Ç–æ –ø—Ä–æ–¥–∞—ë–º)
  - Purchase Process and Delivery (–∫–æ–≥–¥–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º)
  - **REFUNDS POLICY**: **ALL SALES ARE FINAL** - –ø—Ä–æ–ø–∏—Å–∞–Ω–æ –∫—Ä—É–ø–Ω–æ
  - Responsibility After Delivery (–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –ø–æ–∫—É–ø–∞—Ç–µ–ª—è)
  - Limitations of Liability (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏)
  - Dispute Resolution & Arbitration
  - Class Action Waiver

**–ö—Ä–∏—Ç–∏—á–Ω—ã–π —Ä–∞–∑–¥–µ–ª 4:**
```
4. REFUNDS, RETURNS, AND REPLACEMENT POLICY
4.1. No Refunds Policy
ALL SALES ARE FINAL. Due to the nature of digital products...

4.2. Your Responsibility After Delivery
Once the digital code has been delivered, you assume ALL responsibility...

4.6. Exclusions
We will NOT provide refunds or replacements if:
- Code already redeemed
- Wrong region
- Account banned
- Code expired due to YOUR delay
- You changed your mind
...
```

#### Privacy Policy (`/[locale]/privacy`)
- **GDPR-compliant**
- 12 —Ä–∞–∑–¥–µ–ª–æ–≤
- –ü—Ä–æ–ø–∏—Å–∞–Ω–æ –≤—Å—ë, —á—Ç–æ –ª–æ–≥–∏—Ä—É–µ–º:
  - Email, IP addresses, User-Agent
  - UTM parameters (source, medium, campaign)
  - Analytics events (views, clicks, purchases)
  - Session ID
  - Payment info (—á–µ—Ä–µ–∑ Cardlink)
- –ü—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (Right to Access, Erasure, etc.)
- International data transfers
- Cookie policy

#### Refund Policy (`/[locale]/refund`)
- **–û—Ç–¥–µ–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞** —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ "NO REFUNDS"
- –ß—ë—Ç–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –¥–ª—è replacement (–Ω–µ refund!)
- Exclusions (–∫–æ–≥–¥–∞ replacement –ù–ï –¥–∞—ë—Ç—Å—è)
- –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –æ–±—Ä–∞—â–µ–Ω–∏—è (48 —á–∞—Å–æ–≤, –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞)
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ chargebacks (ban + legal action)

#### Brand Disclaimer
–í—Å—Ç—Ä–æ–µ–Ω –≤ Terms:
```
"Lonieve Gift is not affiliated with, endorsed by, or sponsored by 
Amazon, Apple, Google, PlayStation, Steam, Netflix..."
```

### 1.2. –°–∏—Å—Ç–µ–º–∞ —Å–æ–≥–ª–∞—Å–∏—è

**–ß–µ–∫–±–æ–∫—Å –≤ Checkout:**
```tsx
<input type="checkbox" checked={agreedToTerms} />
<label>
  I have read and agree to the Terms of Service, Privacy Policy, 
  and Refund Policy. I understand that all sales are final and 
  no refunds will be provided after delivery.
</label>
```

**–ö–Ω–æ–ø–∫–∞ "Pay Now" disabled –ø–æ–∫–∞ –Ω–µ —Å–æ–≥–ª–∞—Å–µ–Ω**

**–°—Å—ã–ª–∫–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ** (`target="_blank"`)

### 1.3. –§—É—Ç–µ—Ä

–û–±–Ω–æ–≤–ª—ë–Ω —Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –≤—Å–µ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
- Terms of Service
- Privacy Policy
- Refund Policy
- FAQ
- About
- Contact

---

## ‚úÖ 2. –ù–ê–î–Å–ñ–ù–ê–Ø –í–´–î–ê–ß–ê –ö–û–î–û–í

### 2.1. Idempotency (–∑–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤)

**–ü—Ä–æ–±–ª–µ–º–∞:** Webhook –æ—Ç Cardlink –º–æ–∂–µ—Ç –ø—Ä–∏–π—Ç–∏ –¥–≤–∞–∂–¥—ã ‚Üí –æ–¥–∏–Ω –∫–æ–¥ –¥–≤—É–º –ª—é–¥—è–º.

**–†–µ—à–µ–Ω–∏–µ:**
1. –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `processed_at` –≤ `payments`
2. –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `idempotency_key` (UNIQUE constraint)
3. –ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ webhook:
   ```sql
   UPDATE payments 
   SET processed_at = NOW(), idempotency_key = ...
   WHERE bill_id = ? AND processed_at IS NULL
   ```
4. –ï—Å–ª–∏ `processed_at` —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω ‚Üí –≤–æ–∑–≤—Ä–∞—Ç `success` (idempotent)

### 2.2. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø)

**–ü—Ä–æ–±–ª–µ–º–∞:** –î–≤–∞ webhook –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –º–æ–≥—É—Ç –≤–∑—è—Ç—å –æ–¥–∏–Ω –∫–æ–¥.

**–†–µ—à–µ–Ω–∏–µ:**
```sql
UPDATE gift_codes 
SET status = 'sold', order_item_id = ?, used_at = NOW()
WHERE product_id = ? 
  AND nominal = ? 
  AND status = 'available' 
  AND order_item_id IS NULL
LIMIT 1
RETURNING *
```

**Atomic operation** - —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–∏—Ç —Å—Ç—Ä–æ–∫—É.

### 2.3. Fallback –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∫–æ–¥–æ–≤

**–ï—Å–ª–∏ –∫–æ–¥–∞ –Ω–µ—Ç:**
1. Order ‚Üí status = `'manual_review'`
2. –°–æ–∑–¥–∞—ë—Ç—Å—è **critical alert** –≤ `system_notifications`
3. Webhook –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `warning: 'Order requires manual review'`
4. –ê–¥–º–∏–Ω –≤–∏–¥–∏—Ç —ç—Ç–æ –≤ **Alerts** –ø–∞–Ω–µ–ª–∏

---

## ‚úÖ 3. –û–ë–†–ê–ë–û–¢–ö–ê –§–ï–ô–õ–û–í

### 3.1. Webhook Logs (–ø–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)

**–ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞: `webhook_logs`**
```sql
CREATE TABLE webhook_logs (
  id UUID PRIMARY KEY,
  provider TEXT,           -- 'cardlink'
  event_type TEXT,         -- 'payment_notification'
  bill_id TEXT,
  order_id TEXT,
  status TEXT,             -- 'PAID', 'FAILED'
  request_body JSONB,      -- –≤–µ—Å—å JSON
  response_status INTEGER, -- 200, 401, 404, 500
  processed BOOLEAN,       -- —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω?
  error TEXT,              -- —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏
  created_at TIMESTAMPTZ
)
```

**–ö–∞–∂–¥—ã–π webhook:**
1. **–°—Ä–∞–∑—É –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è** (–¥–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏)
2. –ü—Ä–∏ —É—Å–ø–µ—Ö–µ ‚Üí `processed = true, response_status = 200`
3. –ü—Ä–∏ –æ—à–∏–±–∫–µ ‚Üí `error = '...', response_status = 500`
4. –ú–æ–∂–Ω–æ **audit trail** - —Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –≤—ã–∑–æ–≤—ã

**–ê–¥–º–∏–Ω–∫–∞: `/admin/webhooks`**
- –¢–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö webhooks
- –§–∏–ª—å—Ç—Ä –ø–æ processed/failed
- –î–µ—Ç–∞–ª–∏ –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

### 3.2. Email Retry & Failed Status

**–ù–æ–≤—ã–µ –ø–æ–ª—è –≤ `orders`:**
- `email_status` - 'pending', 'sent', 'failed'
- `email_sent_at` - –∫–æ–≥–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω
- `email_retry_count` - —Å–∫–æ–ª—å–∫–æ –ø–æ–ø—ã—Ç–æ–∫

**–õ–æ–≥–∏–∫–∞:**
```typescript
try {
  await sendOrderConfirmation(order_id);
  order.email_status = 'sent';
} catch (error) {
  order.email_status = 'failed';
  order.email_retry_count = 0;
  
  // Create CRITICAL alert
  system_notifications.insert({
    type: 'email_failed',
    severity: 'critical',
    message: 'Failed to send codes...'
  });
}
```

**–ö–Ω–æ–ø–∫–∞ –≤ –∞–¥–º–∏–Ω–∫–µ:** "Resend Email" –¥–ª—è failed orders

### 3.3. Pending Payments Cron

**SQL Function:** `check_pending_payments()`
```sql
SELECT * FROM payments 
WHERE status = 'pending' 
AND created_at < NOW() - INTERVAL '30 minutes'
```

**–°–æ–∑–¥–∞—ë—Ç alert:** "Payment pending for more than 30 minutes"

**–ó–∞–ø—É—Å–∫–∞—Ç—å —á–µ—Ä–µ–∑:**
- Supabase Edge Function (cron)
- Vercel Cron Jobs
- GitHub Actions (scheduled)

---

## ‚úÖ 4. ALERTS –°–ò–°–¢–ï–ú–ê (REAL-TIME)

### 4.1. –¢–∞–±–ª–∏—Ü–∞ `system_notifications`

```sql
CREATE TABLE system_notifications (
  id UUID PRIMARY KEY,
  type TEXT,              -- 'low_stock', 'pending_payment', 'email_failed'
  severity TEXT,          -- 'info', 'warning', 'critical'
  title TEXT,
  message TEXT,
  related_entity_type,    -- 'product', 'order', 'payment'
  related_entity_id UUID,
  is_read BOOLEAN,
  is_resolved BOOLEAN,
  created_at TIMESTAMPTZ,
  resolved_at TIMESTAMPTZ
)
```

### 4.2. Automatic Triggers

**Low Stock Trigger:**
```sql
CREATE TRIGGER trigger_check_low_stock
AFTER UPDATE ON gift_codes
FOR EACH ROW
WHEN (OLD.status = 'available' AND NEW.status != 'available')
EXECUTE FUNCTION check_low_stock();
```

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç alert –∫–æ–≥–¥–∞ –∫–æ–¥–æ–≤ < 5.

**Manual Review:**
–ö–æ–≥–¥–∞ –Ω–µ—Ç –∫–æ–¥–æ–≤ –¥–ª—è –æ–ø–ª–∞—á–µ–Ω–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞ ‚Üí —Å–æ–∑–¥–∞—ë—Ç—Å—è critical alert.

**Email Failed:**
–ü—Ä–∏ –æ—à–∏–±–∫–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ email ‚Üí critical alert.

### 4.3. –ê–¥–º–∏–Ω–∫–∞ `/admin/alerts`

**Dashboard:**
- Unresolved alerts count
- Critical count (–∫—Ä–∞—Å–Ω—ã–π)
- Warnings count (–æ—Ä–∞–Ω–∂–µ–≤—ã–π)

**–°–ø–∏—Å–æ–∫ –∞–ª–µ—Ä—Ç–æ–≤:**
- –ò–∫–æ–Ω–∫–∞ –ø–æ —Ç–∏–ø—É (üì¶ low_stock, ‚è≥ pending, ‚úâÔ∏è email_failed)
- Severity badge (Critical/Warning/Info)
- Timestamp
- –°–æ–æ–±—â–µ–Ω–∏–µ
- Related entity (order ID, product ID)
- **–ö–Ω–æ–ø–∫–∞ "Mark Resolved"**

**–í —Å–∞–π–¥–±–∞—Ä–µ –∞–¥–º–∏–Ω–∫–∏:**
- Badge —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º unresolved alerts (–∫—Ä–∞—Å–Ω—ã–π –∫—Ä—É–∂–æ–∫)

---

## ‚úÖ 5. –ê–ù–ê–õ–ò–¢–ò–ö–ê (GA4 + META PIXEL)

### 5.1. Google Analytics 4

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** `src/lib/analytics/ga4.ts`

**E-commerce events:**
```typescript
- view_item         // –ø—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ–¥—É–∫—Ç–∞
- add_to_cart       // –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É
- begin_checkout    // –Ω–∞—á–∞–ª–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è
- purchase          // –ø–æ–∫—É–ø–∫–∞ (—Å transaction_id)
```

**–ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –≤ layout.tsx:**
```html
<Script src="https://www.googletagmanager.com/gtag/js?id=GA_ID" />
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```typescript
import { trackViewItem, trackPurchase } from '@/lib/analytics/ga4';

trackViewItem({
  id: product.id,
  name: product.brand,
  price: discountedPrice,
  currency: 'USD'
});
```

### 5.2. Meta Pixel (Facebook/Instagram)

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** `src/lib/analytics/meta-pixel.ts`

**Events:**
```typescript
- ViewContent       // –ø—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ–¥—É–∫—Ç–∞
- AddToCart         // –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ
- InitiateCheckout  // –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ
- Purchase          // –ø–æ–∫—É–ø–∫–∞
```

**Auto-init –≤ layout:**
```html
<Script id="meta-pixel">
  fbq('init', META_PIXEL_ID);
  fbq('track', 'PageView');
</Script>
```

### 5.3. .env.local

–î–æ–±–∞–≤–∏—Ç—å:
```env
NEXT_PUBLIC_GA_MEASUREMENT_ID=G-XXXXXXXXXX
NEXT_PUBLIC_META_PIXEL_ID=123456789
```

---

## ‚úÖ 6. UX –£–õ–£–ß–®–ï–ù–ò–Ø

### 6.1. –°–∫–µ–ª–µ—Ç–æ–Ω—ã (Loading States)

**TODO –¥–ª—è –¥–µ–≤–µ–ª–æ–ø–µ—Ä–∞:**
- Skeleton –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –∫–∞—Ç–∞–ª–æ–≥–∞
- Skeleton –¥–ª—è product page
- Skeleton –¥–ª—è dashboard

### 6.2. –ü—É—Å—Ç—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–î–æ–±–∞–≤–ª–µ–Ω—ã:**
- "No orders yet" –≤ `/account`
- "No alerts" –≤ `/admin/alerts`
- "No products found" –≤ –∫–∞—Ç–∞–ª–æ–≥–µ

### 6.3. 404/500 Pages

**TODO:**
- –ö–∞—Å—Ç–æ–º–Ω–∞—è 404 —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤ —Å—Ç–∏–ª–µ —Å–∞–π—Ç–∞
- –ö–∞—Å—Ç–æ–º–Ω–∞—è error page

---

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –î–û–†–ê–ë–û–¢–û–ö

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã (23):
1. `src/lib/legal/terms-content.ts` - Terms of Service –∫–æ–Ω—Ç–µ–Ω—Ç
2. `src/lib/legal/privacy-content.ts` - Privacy Policy –∫–æ–Ω—Ç–µ–Ω—Ç
3. `src/app/[locale]/terms/page.tsx` - –°—Ç—Ä–∞–Ω–∏—Ü–∞ Terms
4. `src/app/[locale]/privacy/page.tsx` - –°—Ç—Ä–∞–Ω–∏—Ü–∞ Privacy
5. `src/app/[locale]/refund/page.tsx` - –°—Ç—Ä–∞–Ω–∏—Ü–∞ Refund Policy
6. `supabase/migrations/20240102000000_critical_improvements.sql` - –ù–æ–≤–∞—è –º–∏–≥—Ä–∞—Ü–∏—è
7. `src/app/[locale]/admin/alerts/page.tsx` - –ê–¥–º–∏–Ω–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤
8. `src/app/[locale]/admin/webhooks/page.tsx` - –ê–¥–º–∏–Ω–∫–∞ webhook logs
9. `src/lib/analytics/ga4.ts` - GA4 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
10. `src/lib/analytics/meta-pixel.ts` - Meta Pixel
11. `CRITICAL_IMPROVEMENTS.md` - –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (6):
1. `src/app/[locale]/checkout/page.tsx` - –î–æ–±–∞–≤–ª–µ–Ω —á–µ–∫–±–æ–∫—Å —Å–æ–≥–ª–∞—Å–∏—è
2. `src/app/api/webhooks/cardlink/route.ts` - Idempotency, transactions, logs, alerts
3. `src/app/[locale]/admin/layout.tsx` - Badge —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º alerts
4. `src/app/layout.tsx` - GA4 –∏ Meta Pixel scripts
5. `src/components/layout/Footer.tsx` - –°—Å—ã–ª–∫–∏ –Ω–∞ legal pages
6. `src/types/database.types.ts` - –ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã

### –ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã –ë–î (2):
1. `webhook_logs` - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö webhooks
2. `system_notifications` - –°–∏—Å—Ç–µ–º–∞ –∞–ª–µ—Ä—Ç–æ–≤

### –ù–æ–≤—ã–µ –ø–æ–ª—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö:
**orders:**
- `email_status` (pending/sent/failed)
- `email_sent_at`
- `email_retry_count`

**payments:**
- `processed_at` (–¥–ª—è idempotency)
- `idempotency_key` (UNIQUE)

---

## üöÄ –ß–¢–û –¢–ï–ü–ï–†–¨ –†–ê–ë–û–¢–ê–ï–¢

### ‚úÖ –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞
- –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–µ Terms (20+ —Å—Ç—Ä–∞–Ω–∏—Ü)
- GDPR-compliant Privacy Policy
- –ß—ë—Ç–∫–∞—è Refund Policy (NO REFUNDS)
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ
- Brand disclaimer

### ‚úÖ –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å
- **Idempotency** - –¥—É–±–ª–∏—Ä—É—é—â–∏–µ webhooks –±–µ–∑–æ–ø–∞—Å–Ω—ã
- **Atomic code assignment** - –Ω–µ—Ç race conditions
- **Fallback** –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∫–æ–¥–æ–≤ (manual review)
- **Webhook logs** - –ø–æ–ª–Ω—ã–π audit trail
- **Email retry** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã –∏ alerts

### ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- **Real-time alerts** –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö
- **Low stock alerts** (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- **Failed emails alerts**
- **Pending payments alerts**
- **Webhook failures tracking**
- –ê–¥–º–∏–Ω–∫–∞ —Å badge (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ—Ä–µ—à—ë–Ω–Ω—ã—Ö)

### ‚úÖ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
- **GA4 e-commerce events** (view, cart, purchase)
- **Meta Pixel events** (–¥–ª—è —Ä–µ—Ç–∞—Ä–≥–µ—Ç–∏–Ω–≥–∞)
- **UTM tracking** –≤ –ë–î
- **Session tracking**
- –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –¥–ª—è performance marketing

---

## üîÑ CRON JOBS (–ù–ê–°–¢–†–û–ò–¢–¨)

### –ü—Ä–æ–≤–µ—Ä–∫–∞ pending payments (–∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç)
```sql
SELECT check_pending_payments();
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ failed emails (–∫–∞–∂–¥—ã–π —á–∞—Å)
```sql
SELECT check_failed_emails();
```

### –í–∞—Ä–∏–∞–Ω—Ç—ã –∑–∞–ø—É—Å–∫–∞:
1. **Supabase Edge Functions** —Å pg_cron
2. **Vercel Cron Jobs** (vercel.json)
3. **GitHub Actions** (scheduled workflow)
4. **External cron service** (cron-job.org)

---

## üìù NEXT STEPS (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### Priority 1 (–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ):
- [ ] Skeleton loaders –¥–ª—è –ª—É—á—à–µ–≥–æ UX
- [ ] –ö–∞—Å—Ç–æ–º–Ω—ã–µ 404/500 —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- [ ] About Us —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å real SMTP (Mailgun/SES)

### Priority 2 (–µ—Å–ª–∏ —Ç—Ä–∞—Ñ–∏–∫):
- [ ] –ü—Ä–æ–º–æ–∫–æ–¥—ã (—Ç–∞–±–ª–∏—Ü–∞ + –ª–æ–≥–∏–∫–∞)
- [ ] Referral —Å–∏—Å—Ç–µ–º–∞
- [ ] B2B —Ñ–æ—Ä–º–∞ –∑–∞—è–≤–æ–∫
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–æ–≤ (CSV)

### Priority 3 (–º–∞—Å —à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ):
- [ ] Multi-domain (tenants —Ç–∞–±–ª–∏—Ü–∞)
- [ ] A/B testing
- [ ] Advanced fraud detection
- [ ] Loyalty program

---

## üéØ –ò–¢–û–ì

**–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Ç–µ–ø–µ—Ä—å production-ready —Å:**
- ‚úÖ –Æ—Ä–∏–¥–∏—á–µ—Å–∫–æ–π –∑–∞—â–∏—Ç–æ–π (Terms + Privacy + Refund)
- ‚úÖ –ù–∞–¥—ë–∂–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ø–ª–∞—Ç–µ–∂–µ–π (idempotency + transactions)
- ‚úÖ Real-time –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º (alerts —Å–∏—Å—Ç–µ–º–∞)
- ‚úÖ –ü–æ–ª–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º (webhooks, emails)
- ‚úÖ –ê–Ω–∞–ª–∏—Ç–∏–∫–æ–π –¥–ª—è –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞ (GA4 + Meta)
- ‚úÖ –ó–∞—â–∏—Ç–æ–π –æ—Ç –±–∞–≥–æ–≤ (race conditions, double processing)

**–ì–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É –∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ!** üöÄ

