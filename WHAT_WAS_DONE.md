# –ß–¢–û –ë–´–õ–û –°–î–ï–õ–ê–ù–û - –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –î–û–†–ê–ë–û–¢–ö–ò

## üéØ –†–ï–ó–Æ–ú–ï

–í—ã–ø–æ–ª–Ω–µ–Ω—ã **–í–°–ï –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏** –¥–ª—è production-ready –∑–∞–ø—É—Å–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Lonieve Gift.
–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Ç–µ–ø–µ—Ä—å –∑–∞—â–∏—â–µ–Ω–∞ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏, –Ω–∞–¥—ë–∂–Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏, –∏ –≥–æ—Ç–æ–≤–∞ –∫ –≤—ã—Å–æ–∫–æ–º—É —Ç—Ä–∞—Ñ–∏–∫—É.

---

## 1Ô∏è‚É£ –Æ–†–ò–î–ò–ö–ê –ò –î–û–í–ï–†–ò–ï ‚úÖ

### –°–æ–∑–¥–∞–Ω—ã –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–µ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:

#### üìÑ Terms of Service (`/[locale]/terms`)
- **13 –±–æ–ª—å—à–∏—Ö —Ä–∞–∑–¥–µ–ª–æ–≤** (~20-30 —Å—Ç—Ä–∞–Ω–∏—Ü —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–∞)
- **–†–∞–∑–¥–µ–ª 4: REFUNDS POLICY**
  - **ALL SALES ARE FINAL** - –ø—Ä–æ–ø–∏—Å–∞–Ω–æ –∫—Ä—É–ø–Ω—ã–º–∏ –±—É–∫–≤–∞–º–∏
  - –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –ø–æ—Å–ª–µ –¥–æ—Å—Ç–∞–≤–∫–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ
  - –ù–µ—Ç refunds –Ω–∏ –ø—Ä–∏ –∫–∞–∫–∏—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö
  - Replacement (–∑–∞–º–µ–Ω–∞) –¢–û–õ–¨–ö–û –ø—Ä–∏ proof —á—Ç–æ –∫–æ–¥ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
  - –°–ø–∏—Å–æ–∫ exclusions (–∫–æ–≥–¥–∞ replacement –ù–ï –¥–∞—ë—Ç—Å—è)
  
**–í–ê–ñ–ù–û:** –ù–∞ —Å–∞–π—Ç–µ –Ω–∏–≥–¥–µ –Ω–µ –ø–∏—à–µ–º "no refunds", —Ç–æ–ª—å–∫–æ –≤ Terms.

#### üîí Privacy Policy (`/[locale]/privacy`)
- **12 —Ä–∞–∑–¥–µ–ª–æ–≤**, GDPR-compliant
- –ü—Ä–æ–ø–∏—Å–∞–Ω–æ –í–°–Å —á—Ç–æ –ª–æ–≥–∏—Ä—É–µ–º:
  - Email, IP, User-Agent
  - UTM –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (source, medium, campaign)
  - Analytics events
  - Session ID
  - Payment data
- –ü—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (access, erasure, portability)
- International data transfers

#### üí∏ Refund Policy (`/[locale]/refund`)
- –û—Ç–¥–µ–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ "NO REFUNDS"
- –ß—ë—Ç–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –¥–ª—è replacement
- –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –æ–±—Ä–∞—â–µ–Ω–∏—è (48 —á–∞—Å–æ–≤, –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞)
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ chargebacks (ban + legal action)

#### üè∑Ô∏è Brand Disclaimer
–í—Å—Ç—Ä–æ–µ–Ω –≤ Terms:
```
"Lonieve Gift is not affiliated with Amazon, Apple, Google, 
PlayStation, Steam, Netflix..."
```

### ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Å–æ–≥–ª–∞—Å–∏—è –≤ Checkout:

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —á–µ–∫–±–æ–∫—Å:**
```
‚òëÔ∏è I have read and agree to the Terms of Service, Privacy Policy, 
   and Refund Policy. I understand that all sales are final and 
   no refunds will be provided after delivery.
```

- –ö–Ω–æ–ø–∫–∞ "Pay Now" **disabled** –ø–æ–∫–∞ –Ω–µ —Å–æ–≥–ª–∞—Å–∏–ª—Å—è
- –í—Å–µ —Å—Å—ã–ª–∫–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ
- –ß–µ–∫–±–æ–∫—Å –≤—Å–µ–≥–¥–∞ –≤–∏–¥–µ–Ω, –Ω–µ–ª—å–∑—è –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å

### üìç Footer –æ–±–Ω–æ–≤–ª—ë–Ω
–î–æ–±–∞–≤–ª–µ–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ –≤—Å–µ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

---

## 2Ô∏è‚É£ –ù–ê–î–Å–ñ–ù–ê–Ø –í–´–î–ê–ß–ê –ö–û–î–û–í ‚úÖ

### üîê Idempotency (–∑–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–µ–π)

**–ü—Ä–æ–±–ª–µ–º–∞:** Webhook –æ—Ç Cardlink –º–æ–∂–µ—Ç –ø—Ä–∏–π—Ç–∏ –¥–≤–∞–∂–¥—ã ‚Üí –æ–¥–∏–Ω –∫–æ–¥ –¥–≤—É–º –∫–ª–∏–µ–Ω—Ç–∞–º.

**–†–µ—à–µ–Ω–∏–µ:**
- –ù–æ–≤–æ–µ –ø–æ–ª–µ `payments.processed_at`
- –ù–æ–≤–æ–µ –ø–æ–ª–µ `payments.idempotency_key` (UNIQUE)
- –ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º: —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω? ‚Üí return success
- UPDATE —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `processed_at IS NULL`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Webhook –º–æ–∂–µ—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å 10 —Ä–∞–∑ - –∫–æ–¥ –≤—ã–¥–∞—Å—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑.

### ‚öõÔ∏è Atomic Code Assignment

**–ü—Ä–æ–±–ª–µ–º–∞:** –î–≤–∞ webhook –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –º–æ–≥—É—Ç –≤–∑—è—Ç—å –æ–¥–∏–Ω –∫–æ–¥.

**–†–µ—à–µ–Ω–∏–µ:**
```sql
UPDATE gift_codes 
SET status = 'sold', order_item_id = ?
WHERE product_id = ? 
  AND nominal = ? 
  AND status = 'available'
  AND order_item_id IS NULL
LIMIT 1
RETURNING *
```

**Atomic operation** - —Ç–æ–ª—å–∫–æ –û–î–ò–ù –∑–∞–ø—Ä–æ—Å —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–∏—Ç —Å—Ç—Ä–æ–∫—É.
–û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—É—á–∞—Ç 0 rows affected.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Race condition –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω.

### üö® Fallback –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∫–æ–¥–æ–≤

**–ï—Å–ª–∏ –∫–æ–¥–∞ –Ω–µ—Ç:**
1. Order ‚Üí `status = 'manual_review'`
2. –°–æ–∑–¥–∞—ë—Ç—Å—è **CRITICAL alert** –≤ –∞–¥–º–∏–Ω–∫–µ
3. Email –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è (–Ω–µ—á–µ–≥–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å)
4. –ê–¥–º–∏–Ω –≤–∏–¥–∏—Ç –≤ **Alerts**: "No codes available for paid order"

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ö–ª–∏–µ–Ω—Ç –ù–ï –ø–æ–ª—É—á–∏—Ç –ø—É—Å—Ç–æ–π email, –∞–¥–º–∏–Ω –∑–Ω–∞–µ—Ç –æ –ø—Ä–æ–±–ª–µ–º–µ —Å—Ä–∞–∑—É.

---

## 3Ô∏è‚É£ –û–ë–†–ê–ë–û–¢–ö–ê –§–ï–ô–õ–û–í ‚úÖ

### üìù Webhook Logs (–ø–æ–ª–Ω—ã–π audit trail)

**–ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞: `webhook_logs`**

–ö–∞–∂–¥—ã–π webhook:
1. **–°—Ä–∞–∑—É –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è** (–¥–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏)
2. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤–µ—Å—å request body (JSONB)
3. –ü—Ä–∏ —É—Å–ø–µ—Ö–µ ‚Üí `processed = true, response_status = 200`
4. –ü—Ä–∏ –æ—à–∏–±–∫–µ ‚Üí `error = '...', response_status = 500`

**–ê–¥–º–∏–Ω–∫–∞ `/admin/webhooks`:**
- –¢–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö webhooks
- –ú–æ–∂–Ω–æ —Å–º–æ—Ç—Ä–µ—Ç—å failed
- Audit trail –¥–ª—è troubleshooting

### ‚úâÔ∏è Email Retry & Failed Alerts

**–ù–æ–≤—ã–µ –ø–æ–ª—è –≤ `orders`:**
- `email_status` - 'pending' | 'sent' | 'failed'
- `email_sent_at`
- `email_retry_count`

**–õ–æ–≥–∏–∫–∞:**
```typescript
try {
  await sendOrderConfirmation(order_id);
  // Success: email_status = 'sent'
} catch (error) {
  // Failed: email_status = 'failed'
  // Create CRITICAL alert
  // –ö–Ω–æ–ø–∫–∞ "Resend" –≤ –∞–¥–º–∏–Ω–∫–µ
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ï—Å–ª–∏ email —É–ø–∞–ª - –∞–¥–º–∏–Ω –∑–Ω–∞–µ—Ç —Å—Ä–∞–∑—É, –º–æ–∂–µ—Ç –ø–µ—Ä–µ–æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é.

### ‚è±Ô∏è Pending Payments Monitoring

**SQL —Ñ—É–Ω–∫—Ü–∏—è: `check_pending_payments()`**

–ù–∞—Ö–æ–¥–∏—Ç –ø–ª–∞—Ç–µ–∂–∏ pending > 30 –º–∏–Ω—É—Ç:
- –°–æ–∑–¥–∞—ë—Ç warning alert
- –ê–¥–º–∏–Ω –º–æ–∂–µ—Ç –≤—Ä—É—á–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —á–µ—Ä–µ–∑ Cardlink
- –ò–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å auto-check —á–µ—Ä–µ–∑ API

**–ó–∞–ø—É—Å–∫–∞—Ç—å —á–µ—Ä–µ–∑ cron** (–∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç).

---

## 4Ô∏è‚É£ ALERTS –°–ò–°–¢–ï–ú–ê (REAL-TIME) ‚úÖ

### üîî –¢–∞–±–ª–∏—Ü–∞ `system_notifications`

```sql
type: 'low_stock' | 'pending_payment' | 'email_failed' | 'webhook_failed'
severity: 'info' | 'warning' | 'critical'
title, message
related_entity (order_id, product_id)
is_resolved
```

### ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã:

**Low Stock Trigger:**
```sql
CREATE TRIGGER trigger_check_low_stock
AFTER UPDATE ON gift_codes
-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç alert –∫–æ–≥–¥–∞ –∫–æ–¥–æ–≤ < 5
```

**Manual Review:**
–ù–µ—Ç –∫–æ–¥–æ–≤ –¥–ª—è paid order ‚Üí critical alert

**Email Failed:**
–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ ‚Üí critical alert

**Webhook Failed:**
–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ ‚Üí error alert

### üìä –ê–¥–º–∏–Ω–∫–∞ `/admin/alerts`

**Dashboard:**
- –°—á—ë—Ç—á–∏–∫ unresolved alerts
- Critical alerts (–∫—Ä–∞—Å–Ω—ã–µ)
- Warning alerts (–æ—Ä–∞–Ω–∂–µ–≤—ã–µ)

**–°–ø–∏—Å–æ–∫:**
- –ò–∫–æ–Ω–∫–∞ –ø–æ —Ç–∏–ø—É (üì¶ üìß ‚è≥ ‚ö†Ô∏è)
- Severity badge
- Timestamp
- –î–µ—Ç–∞–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã
- **–ö–Ω–æ–ø–∫–∞ "Mark Resolved"**

**–í —Å–∞–π–¥–±–∞—Ä–µ:**
- Red badge —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –Ω–µ—Ä–µ—à—ë–Ω–Ω—ã—Ö

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ê–¥–º–∏–Ω –≤–∏–¥–∏—Ç –ø—Ä–æ–±–ª–µ–º—ã –î–û —Ç–æ–≥–æ, –∫–∞–∫ –∫–ª–∏–µ–Ω—Ç—ã –ø–æ–∂–∞–ª—É—é—Ç—Å—è.

---

## 5Ô∏è‚É£ –ê–ù–ê–õ–ò–¢–ò–ö–ê (GA4 + META) ‚úÖ

### üìà Google Analytics 4

**–§–∞–π–ª: `src/lib/analytics/ga4.ts`**

**E-commerce events:**
```typescript
trackViewItem()        // –ø—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ–¥—É–∫—Ç–∞
trackAddToCart()       // –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É
trackBeginCheckout()   // –Ω–∞—á–∞–ª–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è
trackPurchase()        // –ø–æ–∫—É–ø–∫–∞ (—Å transaction_id)
```

**Auto-load –≤ layout.tsx:**
```html
<Script src="https://www.googletagmanager.com/gtag/js?id=GA_ID" />
```

### üì± Meta Pixel (Facebook/Instagram)

**–§–∞–π–ª: `src/lib/analytics/meta-pixel.ts`**

**Events:**
```typescript
trackMetaViewContent()      // –ø—Ä–æ—Å–º–æ—Ç—Ä
trackMetaAddToCart()        // –∫–æ—Ä–∑–∏–Ω–∞
trackMetaInitiateCheckout() // –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ
trackMetaPurchase()         // –ø–æ–∫—É–ø–∫–∞
```

**Auto-init –≤ layout:**
```html
<Script>fbq('init', META_PIXEL_ID);</Script>
```

### üéØ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

**–í .env.local:**
```env
NEXT_PUBLIC_GA_MEASUREMENT_ID=G-XXXXXXXXXX
NEXT_PUBLIC_META_PIXEL_ID=123456789012345
```

**–í –∫–æ–¥–µ:**
```typescript
import { trackViewItem } from '@/lib/analytics/ga4';
trackViewItem({ id, name, brand, price, currency });
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
- –ü–æ–ª–Ω—ã–π tracking –¥–ª—è Google Ads –∏ Facebook Ads
- –†–µ—Ç–∞—Ä–≥–µ—Ç–∏–Ω–≥ –∞—É–¥–∏—Ç–æ—Ä–∏–∏
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–∞–º–ø–∞–Ω–∏–π –ø–æ purchase events

---

## 6Ô∏è‚É£ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø ‚úÖ

### üìã –ê–¥–º–∏–Ω–∫–∞ —É–ª—É—á—à–µ–Ω–∞:
- `/admin/alerts` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–ª–µ—Ä—Ç–æ–≤
- `/admin/webhooks` - –ª–æ–≥–∏ webhooks
- Badge –≤ sidebar —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –Ω–µ—Ä–µ—à—ë–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

### üóÇÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:
**2 –Ω–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã:**
- `webhook_logs` - –≤—Å–µ webhooks
- `system_notifications` - –≤—Å–µ alerts

**–ù–æ–≤—ã–µ –ø–æ–ª—è:**
- `orders`: email_status, email_sent_at, email_retry_count
- `payments`: processed_at, idempotency_key

**Triggers:**
- Auto-check low stock
- Auto-create alerts

### üìÑ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- `CRITICAL_IMPROVEMENTS.md` - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Ä–∞–±–æ—Ç–æ–∫
- `WHAT_WAS_DONE.md` - —ç—Ç–æ —Ä–µ–∑—é–º–µ
- README –æ–±–Ω–æ–≤–ª—ë–Ω —Å –Ω–æ–≤—ã–º–∏ features

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –ì–û–¢–û–í–ù–û–°–¢–ò

### –Æ—Ä–∏–¥–∏–∫–∞:
- [x] Terms of Service (20+ —Å—Ç—Ä–∞–Ω–∏—Ü)
- [x] Privacy Policy (GDPR)
- [x] Refund Policy (NO REFUNDS)
- [x] Brand Disclaimer
- [x] –ß–µ–∫–±–æ–∫—Å —Å–æ–≥–ª–∞—Å–∏—è –≤ checkout
- [x] –°—Å—ã–ª–∫–∏ –≤ —Ñ—É—Ç–µ—Ä–µ

### –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å:
- [x] Idempotency webhooks
- [x] Atomic code assignment
- [x] Fallback –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∫–æ–¥–æ–≤
- [x] Webhook logging
- [x] Email retry mechanism
- [x] Pending payments monitoring

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
- [x] Real-time alerts —Å–∏—Å—Ç–µ–º–∞
- [x] Low stock –∞–≤—Ç–æ–∞–ª–µ—Ä—Ç—ã
- [x] Email failed alerts
- [x] Webhook failed logging
- [x] –ê–¥–º–∏–Ω–∫–∞ alerts —Å badge

### –ê–Ω–∞–ª–∏—Ç–∏–∫–∞:
- [x] GA4 integration
- [x] Meta Pixel integration
- [x] E-commerce events
- [x] UTM tracking –≤ –ë–î

---

## üöÄ –ì–û–¢–û–í–û –ö –ó–ê–ü–£–°–ö–£

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ò–ó –ö–û–†–û–ë–ö–ò:
‚úÖ –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞ (–ø–æ–ª–Ω—ã–µ Terms/Privacy/Refund)
‚úÖ –ù–∞–¥—ë–∂–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π (idempotency + atomic)
‚úÖ Real-time –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–±–ª–µ–º (alerts)
‚úÖ –ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (webhooks, emails)
‚úÖ –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (GA4 + Meta)
‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –±–∞–≥–æ–≤ (race conditions, doubles)

### –ß—Ç–æ –Ω—É–∂–Ω–æ –ù–ê–°–¢–†–û–ò–¢–¨:

1. **Supabase:**
   - –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é: `supabase/migrations/20240102000000_critical_improvements.sql`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å RLS policies

2. **Environment variables:**
   ```env
   # Optional analytics
   NEXT_PUBLIC_GA_MEASUREMENT_ID=G-XXXXXXXXXX
   NEXT_PUBLIC_META_PIXEL_ID=123456789012345
   ```

3. **Cron jobs (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
   - `check_pending_payments()` - –∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç
   - `check_failed_emails()` - –∫–∞–∂–¥—ã–π —á–∞—Å

4. **Cardlink webhook URL:**
   - `https://your-domain.com/api/webhooks/cardlink`

---

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê

**–°–æ–∑–¥–∞–Ω–æ —Ñ–∞–π–ª–æ–≤:** 11 –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
**–û–±–Ω–æ–≤–ª–µ–Ω–æ —Ñ–∞–π–ª–æ–≤:** 6 —Ñ–∞–π–ª–æ–≤
**–ù–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü –ë–î:** 2 (webhook_logs, system_notifications)
**–ù–æ–≤—ã—Ö –ø–æ–ª–µ–π –≤ –ë–î:** 5 (email_status, processed_at, idempotency_key, etc.)
**–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:** 3 –ø–æ–ª–Ω—ã—Ö (Terms, Privacy, Refund)
**–ê–¥–º–∏–Ω —Å—Ç—Ä–∞–Ω–∏—Ü:** +2 (Alerts, Webhooks)
**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π:** 2 (GA4, Meta Pixel)

**–û–±—â–∏–π –æ–±—ä—ë–º –¥–æ—Ä–∞–±–æ—Ç–æ–∫:** ~5000 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ + –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

## üí° –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### UX —É–ª—É—á—à–µ–Ω–∏—è:
- Skeleton loaders (–¥–ª—è –ª—É—á—à–µ–≥–æ UX)
- –ö–∞—Å—Ç–æ–º–Ω—ã–µ 404/500 —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- About Us —Å—Ç—Ä–∞–Ω–∏—Ü–∞

### –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥:
- –ü—Ä–æ–º–æ–∫–æ–¥—ã (–Ω–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ + –ª–æ–≥–∏–∫–∞)
- Referral —Å–∏—Å—Ç–µ–º–∞
- Email –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ (newsletters)

### –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:
- Multi-domain (tenants table)
- B2B —Å–µ–∫—Ü–∏—è (bulk orders)
- API –¥–ª—è –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤

---

## üéØ –ò–¢–û–ì–û–í–´–ô –í–ï–†–î–ò–ö–¢

**–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ Lonieve Gift —Ç–µ–ø–µ—Ä—å:**

‚úÖ **–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏ –∑–∞—â–∏—â–µ–Ω–∞** - –ø–æ–ª–Ω—ã–µ Terms/Privacy/Refund  
‚úÖ **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –Ω–∞–¥—ë–∂–Ω–∞** - idempotency, atomic ops, logging  
‚úÖ **–õ–µ–≥–∫–æ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—Å—è** - real-time alerts, webhook logs  
‚úÖ **–ì–æ—Ç–æ–≤–∞ –∫ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥—É** - GA4 + Meta Pixel  
‚úÖ **Production-ready** - –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–ª–∞—Ç–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫  

**–ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤. –°–∏—Å—Ç–µ–º–∞ –±–æ–µ–≤–∞—è.** üöÄ

---

## üìû SUPPORT

–ï—Å–ª–∏ –Ω—É–∂–Ω—ã –ø–æ—è—Å–Ω–µ–Ω–∏—è –ø–æ –ª—é–±–æ–π –¥–æ—Ä–∞–±–æ—Ç–∫–µ:
- –°–º–æ—Ç—Ä–∏ `CRITICAL_IMPROVEMENTS.md` - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- –°–º–æ—Ç—Ä–∏ –∫–æ–¥ –≤ —Ñ–∞–π–ª–∞—Ö - –≤—Å—ë –ø—Ä–æ–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ
- –°–º–æ—Ç—Ä–∏ SQL –º–∏–≥—Ä–∞—Ü–∏–∏ - –≤—Å–µ triggers –∏ functions

**–í—Å—ë –≥–æ—Ç–æ–≤–æ –¥–ª—è –∑–∞–ø—É—Å–∫–∞!**

